{"version":3,"sources":["../../src/editor.js"],"names":["Editor","ctrl","path","System","import","then","scope","$apply","setTimeout","el","document","getElementById","textAreaID","console","log","editor","window","ace","edit","setTheme","getSession","setMode","setOptions","enableBasicAutocompletion","$blockScrolling","Infinity","setAutoScrollEditorIntoView","resize","setValue","target","expr","on","ev","getValue"],"mappings":";;;;;QAMgBA,M,GAAAA,M;AANhB;;;;;;AAMO,SAASA,MAAT,CAAgBC,IAAhB,EAAsB;AAC3B,MAAIC,OAAO,4CAAX;;AAEAC,SAAOC,MAAP,CAAcF,OAAO,QAArB,EAA+BG,IAA/B,CAAoC,YAAM;;AAExCF,WAAOC,MAAP,CAAcF,OAAO,uBAArB,EAA8CG,IAA9C,CAAmD,YAAM;;AAEvDF,aAAOC,MAAP,CAAcF,OAAO,oBAArB,EAA2CG,IAA3C,CAAgD,YAAM;;AAEpDF,eAAOC,MAAP,CAAcF,OAAO,kBAArB,EAAyCG,IAAzC,CAA8C,YAAM;;AAElD;AACAJ,eAAKK,KAAL,CAAWC,MAAX;AACAC,qBAAW,YAAM;AACf,gBAAIC,KAAKC,SAASC,cAAT,CAAwBV,KAAKW,UAA7B,CAAT;AACAC,oBAAQC,GAAR,CAAYL,EAAZ;;AAEAI,oBAAQC,GAAR,CAAY,aAAZ;AACA;AACA,gBAAIC,SAASC,OAAOC,GAAP,CAAWC,IAAX,CAAgBT,EAAhB,CAAb;AACA;AACAM,mBAAOI,QAAP,CAAgB,mBAAhB;AACA;AACAJ,mBAAOK,UAAP,GAAoBC,OAApB,CAA4B,qBAA5B;AACA;AACAN,mBAAOO,UAAP,CAAkB;AAChBC,yCAA2B;AADX,aAAlB;AAGA;AACAR,mBAAOS,eAAP,GAAyBC,QAAzB;AACAV,mBAAOW,2BAAP,CAAmC,IAAnC;;AAEAX,mBAAOY,MAAP,CAAc,IAAd;;AAEA;AACAZ,mBAAOa,QAAP,CAAgB3B,KAAK4B,MAAL,CAAYC,IAA5B;;AAEAf,mBAAOgB,EAAP,CAAU,QAAV,EAAoB,UAACC,EAAD,EAAQ;AAC1BnB,sBAAQC,GAAR,CAAY,QAAZ,EAAsBkB,EAAtB;AACA/B,mBAAK4B,MAAL,CAAYC,IAAZ,GAAmBf,OAAOkB,QAAP,EAAnB;AACD,aAHD;AAID,WA5BD,EA4BG,CA5BH;AA6BD,SAjCD;AAkCD,OApCD;AAqCD,KAvCD;AAwCD,GA1CD;AA2CD","file":"editor.js","sourcesContent":["/**\n * Extensions files like ext-language-tools / mode-warpscript / theme-monikai\n * need to prefix their define function with ace :\n * ace.define();\n */\n\nexport function Editor(ctrl) {\n  var path = '/public/plugins/grafana-warp10-datasource/';\n\n  System.import(path + 'ace.js').then(() => {\n\n    System.import(path + 'ext-language_tools.js').then(() => {\n\n      System.import(path + 'mode-warpscript.js').then(() => {\n\n        System.import(path + 'theme-monokai.js').then(() => {\n\n          // force render query directive\n          ctrl.scope.$apply();\n          setTimeout(() => {\n            var el = document.getElementById(ctrl.textAreaID);\n            console.log(el);\n\n            console.log(\"try to link\");\n            // Link to dom\n            var editor = window.ace.edit(el);\n            // Theme\n            editor.setTheme(\"ace/theme/monokai\");\n            // Warpscript language\n            editor.getSession().setMode(\"ace/mode/warpscript\");\n            // Autocompletion\n            editor.setOptions({\n              enableBasicAutocompletion: true\n            });\n            // Resizable\n            editor.$blockScrolling = Infinity;\n            editor.setAutoScrollEditorIntoView(true);\n\n            editor.resize(true);\n\n            // Fill content\n            editor.setValue(ctrl.target.expr);\n\n            editor.on('change', (ev) => {\n              console.log(\"change\", ev);\n              ctrl.target.expr = editor.getValue();\n            });\n          }, 0);\n        });\n      });\n    });\n  });\n};"]}